<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>严格数学验证系统 - AI-Python协作版 v2.1</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:,">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔬 严格数学验证系统</h1>
            <p>基于论文逻辑的AI-Python协作验证框架 v2.1 (增强版)</p>
        </div>

        <div class="main-layout">
            <div class="main-content">
                <!-- Input Section -->
                <div class="input-section">
                    <div class="input-group">
                        <label for="problem-input">📝 数学问题描述:</label>
                        <textarea id="problem-input" placeholder="请输入需要严格验证的数学问题..."></textarea>
                        <button class="convert-btn" id="convert-formulas-btn">转换公式为 LaTeX</button>
                    </div>
                    <div class="input-group" style="margin-top: 15px;">
                        <label for="image-input">🖼️ 上传几何图形 (可选):</label>
                        <input type="file" id="image-input" accept="image/*" style="display: none;">
                        <button type="button" class="upload-btn" onclick="document.getElementById('image-input').click()">选择图片</button>
                        <div id="image-preview-container" style="display: none; margin-top: 15px;">
                            <img id="image-preview" src="#" alt="Image Preview" style="max-width: 100%; border-radius: 8px;"/>
                        </div>
                    </div>
                    <button class="solve-btn" id="solve-button">🚀 启动严格验证流程</button>
                    <button class="stop-btn" id="stop-button" style="display: none;">🛑 停止验证</button>
                </div>

                <!-- Verification Logic Tree -->
                <div class="verification-pipeline">
                    <div class="pipeline-title">🔄 严格数学验证逻辑树</div>
                    <div class="tree-container">
                        <ul class="tree">
                            <li id="tree-node-start">
                                <span>开始</span>
                                <ul>
                                    <li id="tree-node-1">
                                        <span>步骤 1: 初始解/修正</span>
                                        <ul>
                                            <li id="tree-node-2">
                                                <span>步骤 2: 自我改进</span>
                                                <ul>
                                                    <li id="tree-node-3">
                                                        <span>步骤 3: AI 验证</span>
                                                        <ul>
                                                            <li id="tree-node-4">
                                                                <span>步骤 4: Python 验证</span>
                                                                <ul>
                                                                    <li id="tree-node-5" class="tree-decision">
                                                                        <span>决策: 验证通过?</span>
                                                                        <ul>
                                                                            <li id="tree-node-pass" class="tree-branch-pass">
                                                                                <span>是: 连续通过次数 +1</span>
                                                                                <ul>
                                                                                    <li id="tree-node-final" class="tree-decision">
                                                                                        <span>决策: 达到要求?</span>
                                                                                        <ul>
                                                                                            <li id="tree-node-accept" class="tree-branch-pass"><span>接受解答</span></li>
                                                                                        </ul>
                                                                                    </li>
                                                                                </ul>
                                                                            </li>
                                                                            <li id="tree-node-fail" class="tree-branch-fail">
                                                                                <span>否: 重置计数 & 循环</span>
                                                                            </li>
                                                                        </ul>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Loading Spinner -->
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <div class="loading-text" id="loading-text">🤖 正在启动严格验证系统...</div>
                </div>

                <!-- Results Container -->
                <div id="results-container"></div>
            </div>

            <div class="control-panel">
                <!-- AI Config -->
                <div class="config-section">
                    <div class="config-title">🤖 AI配置</div>
                    <div class="config-group">
                        <label for="api-provider">API提供商:</label>
                        <select id="api-provider">
                            <option value="gemini">Google Gemini 2.5 Pro</option>
                            <option value="deepseek">DeepSeek V3</option>
                            <option value="openai">OpenAI GPT-4</option>
                        </select>
                    </div>
                    <div class="config-group">
                        <label for="model-version">模型版本:</label>
                        <select id="model-version"></select>
                    </div>
                    <button class="config-btn" id="test-btn">🔗 测试连接 <span class="status-indicator status-disconnected" id="connection-status"></span></button>
                </div>

                <!-- Verification Config -->
                <div class="config-section">
                    <div class="config-title">⚙️ 验证配置</div>
                    <div class="config-group">
                        <label for="max-iterations">最大迭代次数:</label>
                        <input type="number" id="max-iterations" value="8" min="3" max="15">
                    </div>
                    <div class="config-group">
                        <label for="consecutive-passes-config">连续通过要求:</label>
                        <input type="number" id="consecutive-passes-config" value="3" min="2" max="5">
                    </div>
                    <div class="config-group">
                        <label for="verification-rigor">验证严格度:</label>
                        <select id="verification-rigor">
                            <option value="strict">严格 (推荐)</option>
                            <option value="moderate">适中</option>
                            <option value="lenient">宽松</option>
                        </select>
                    </div>
                </div>

                <!-- File Saving -->
                <div class="save-section">
                    <div class="config-title">💾 文件保存</div>
                    <button class="config-btn" id="save-all-btn" style="margin-bottom: 8px;">📁 批量保存所有文件</button>
                    <button class="config-btn" id="export-data-btn" style="margin-bottom: 8px;">📊 导出验证数据</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/lib/jszip.min.js"></script>
    <script id="MathJax-script" async src="js/lib/tex-mml-chtml.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>